= the  Web,  its  Frameworks  and its  Standards : deconstructing them for a more resilient code base...
Hubert Sablonnière
:author-twitter: @hsablonniere
:author-avatar: img/hsablonniere-profil-2017.jpg
:author-company: Clever Cloud
:author-company-logo: img/clever-cloud-logo.svg
:event: Voxxed CERN
:date: may 1st, 2019

[slide=poster]
Poster

[.time]#00:00:00#

[.stop-music.dark, slide=blank]
Fading to black


[.old.play-music]
== Prologue...

#Wait for music#
#Deep and sad voice#
Wandering in the jungle of the modern Web,

image::img/drawings-optimized/thinking.svg[]

our main character is lost.
Since he started his career, weeks after weeks, years after years,

image::img/drawings-optimized/thinking-words.svg[]

he saw the birth of many revolutionary and promising tools,
but tomorrow, maybe, those could all vanish and be replaced by new ones ... *even more better*.
It is with lots of sadness and a bit of melancholia that he remembers all these frameworks, librairies, code editors and other command line tools.

image::img/drawings-optimized/rip.svg[]

#Whisper#
Please show some respect!
If they haven't already disappeared from our projects,
maybe they already have disappeared from our...

image::img/drawings-optimized/radar.svg[]

coolness radards.
This situation worries him and keeps him up at nights.
In his current job, he has to make technical choices, yet he doesn't know what to do anymore.
It is at this very moment that our main character decided to see...

[.reset-music]
image::img/drawings-optimized/dr-sigma.svg[]

...a therapist.
[.four]#Restart la musique (Gymnopedie)#

image::img/drawings-optimized/talking-legos.svg[]

#Tired and sad voice#
😎 Hello doctor.
#Confident voice#
👩‍⚕️ Hello Mr Sablonnière? So? What can I do for you?
Last time I saw you, it was like 10 years ago...
You just started your first job and you had some kind of PTSD about wether to use "spaces or tabs" and on the pronunciation of "animated guiffs".
#Like a millenial#
😎 You mean djifs, right?

.2 spaces,   it's better!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-thinks.svg[]

#Brag about being a senior dev#
😎 Yeah but that's all in the past now, I was young, I wasn't asking myself the right questions.
I recently took a few steps back about the frontend Web and I made an observation:

.Too much hype,   we've become addicts!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

😎 There's way too much hype around tools and we've all become addicted to them.
👩‍⚕️ Humm, tell me more, what kind of problems does it imply?

image::img/drawings-optimized/projecteur.svg[]

#Energy voice#
😎 So, problem number 1...
#Surprised voice#
👩‍⚕️ Hummm... when someone asks you a question, do you always answer with a PowerPoint?

.I AM NOT   using PowerPoint!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-thinks.svg[]

#Really happy#
😎 Oh yeah! It's very handy, you know.
#Steps down#
Anyway.

.Problem #1
[slide=problem]
Finding solutions   to problems we don't have (yet)

😎 Problème numéro 1...
When we choose a framework, a frontend library and its ecosystem, we often forget the original problem we wanted to solve.
*And yet*, we feel like we already found *the right answer*, *the right solution* to use.
Most of the time, it's the right tool for the right job but sometimes, the solution was designed to solve problems we don't really have.

.Why?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

👩‍⚕️ Why on earth would you do that?

image::img/drawings-optimized/dx-ux.svg[]

😎 Well, sometimes it's because it's **cool**!
But it forces us to put the developer experience before the user experience,
the user of the very product we're trying to build.

image::img/drawings-optimized/giant.svg[]

😎 Sometime it's because it's used or even created by a Web giant, one of the big 5. Oh yeah!
// Ça forme un cycle:
// * les géants l'utilisent
// * on l'utilise
// * les recruteurs nous attirent avec
// * les débutants se forment dessus
// * on créé des confs dédiées
// * on créé des meetups

.Go on, go on... !
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

👩‍⚕️ Go on, go on...

.Problem #2
[slide=problem]
Getting locked into our own ecosystem

😎 Problem number 2...
Once we chose an ecosystem, we tend to get locked into it.
// https://en.wikipedia.org/wiki/Escalation_of_commitment
// https://fr.wikipedia.org/wiki/Escalade_d%27engagement
// https://en.wikipedia.org/wiki/Sunk_cost
// https://fr.wikipedia.org/wiki/Co%C3%BBt_irr%C3%A9cup%C3%A9rable

image::img/drawings-optimized/silos.svg[]

😎 We open a specific door and we stay cosy inside without looking outside, at what others do.
This means we're going to look for "how to do X or Y" with *THIS* ecosytem even if X or Y a pretty much universal frontend problems.
A bit like when we wanted to maniulate arrays or dates with jQuery.
We're going to rewrite yet another "select" or "datagrid" component dedicated to this ecosystem.
We'll prefix all our stackoverflow questions with "angular", "react" or "vue".
And like all fanboys/fangirls,
we don't always see the limitations of what we love,
and we convince ourselves that we need those shiny new features without understanding them very well.

image::img/drawings-optimized/brain.svg[]

😎 We're going to fill our brains with...

image::img/drawings-optimized/brain-fwk.svg[]

😎 ...features and concepts specific to our own ecosystem...
// 😎 Difficile de changer de cap quand on a investi du temps d'apprentissage.

image::img/drawings-optimized/brain-patterns.svg[]

😎 ...instead of filling them with well known standards and patterns.

.Oh, so just like   Apple keynotes?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-thinks.svg[]

👩‍⚕️ Hum, hum, I see...
// Ah vous entendre, on dirait mon fils devant une conférence Apple, quand ils sortent l'iPod ou l'iPhone, je comprends qu'il soit émerveillé
// Mais quand Apple dit "on a viré le jack" il dit, "ah mais ces vraiment des génies" alors qu'il a pas de casque bluetooth
// Rant sur les exemples de code décorés apple

.Problem #3
[slide=problem]
...

😎 Problem number 3...
This one is pretty universal,
We easily forget the basics, the patterns and best practices like SOLID or "separation of concerns".

.Problem #3
[slide=problem]
Writing strongly coupled code   that does not age well with time

We tend to write code that is strongly coupled and that does not age well with time.

image::img/drawings-optimized/layers.svg[]

😎 Instead of having well defined and isolated layers...

image::img/drawings-optimized/layers-mixed.svg[]

😎 ...we write modules that mix several responsibilities and we couple our code to the implementation of global stuffs in the project.
In the end,
* when our own ecosystem evolves,
* when it disappears,
* or when a new standard rises,
it becomes very hard to replace pieces one at a time.

image::img/drawings-optimized/trash.svg[]

😎 We're going to throw away...

image::img/drawings-optimized/trash-brain.svg[]

😎 ...parts of our knowledge...

image::img/drawings-optimized/trash-project.svg[]

😎 ...and lots of code.

.#FeatureLessRefactoring
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

Hashtag "I love feature less refactors"

.WTF?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]


👩‍⚕️ OK, I'm completely lost.
😎 Ah...
Humm, it's a but like my TV.

.Just like my TV!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

😎 Last time I went to see you 10 years ago,
I just started my first job but I also just bought a new TV with my internship money.

image::img/drawings-optimized/tv.svg[]

😎 I still have this TV,
and it works *just* like it did 10 years ago.
Its still working and relevant because it only does one thing and it does it well.
It doesn't know what I'm going to plug into it, it just enforces an interface : HDMI.

image::img/drawings-optimized/tv-pc.svg[]

😎 At first, I plugged a huge desktop computer with some movies,

image::img/drawings-optimized/tv-raspberry.svg[]

😎 then I went for a smaller one.
I plugged many different devices that didn't exist back then,
but it worked.

image::img/drawings-optimized/tv-androidtv.svg[]

😎 I even discovered by accident that on top of receiving audio/video via HDMI,
it could send signals (via HDMI-CEC) to source devices.
Anyway, today, when I look at frontend projects...

image::img/drawings-optimized/tv-vcr.svg[]

😎 I see *this!*
👩‍⚕️ Oh yeah, TV+VCR combos!
I had one of those! It was really handy, you didn't have to worry about configuration and wires, it was almost magical.
But when our VCR broke, we had to throw both away and buy something new.

// image::img/drawings-optimized/tv-vcr-real.svg[]

.Ah, you see?
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-talks.svg[]

😎 Oh, so you see what I mean?
😎 You see why I'm lost?

.OK, OK, I see...
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

👩‍⚕️ OK, OK, I see...
The best solution in your case...

.Group therapy!
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

👩‍⚕️ ...is group therapy with profesionnals from your industry !
so I gathered a small group of people here.

.I'll go   but I'm scared!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-thinks.svg[]

😎 Well... it's not what I call a small group...

.Everything's    gonna be alright!
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

👩‍⚕️ Don't worry, everything's gonna be alright!

[.stop-music, slide=poster]
Hello

[.time]#00:06:00#
Hello everyone!
I'm Hubert Sablonnière,
I'm a Web Developer at #Clever Cloud#,
and today, I want to talk about:
* the Web,
* its frameworks and librairies
* and its standards.
A very simple topic without any polemics or drama.
We're gonna try to deconstruct all this
in the hope of building better web apps tomorrow.

[slide=blank]
Transition

OK, alors on utilise tous pleins d'outils super cools qui nous apportent des solutions...

== What was the  *problem* anyway?

[.time]#00:06:30#
...mais c'était quoi le problème à la base ?
...
Sur cette partie, j'ai essayé de lister les principaux problèmes auquels j'ai fait face dans mes différentes expériences de dev sur le Web.

[slide=needs, display=0]
_

D'un côté, on a les problèmes qu'on veux résoudre pour les utilisatrices et utilisateurs du produit qu'on développe,
et de l'autre, on a les problèmes qu'on rencontre *NOUS* les devs.
...
Alors, en tant que user, on veut :

[slide=needs, display=1]
_

Un 1er chargement rapide.

[slide=needs, display=2]
_

Une fois la page chargée,
on veut que les navigations consécutives soient rapides aussi.
//C'est le critère qui a motivé le fait de faire du rendu côté client.

[slide=needs, display=3]
_

On veut que ce soit fluide et réactif,

[slide=needs, display=4]
_

que la consommation batterie, CPU, RAM reste raisonnable,

[slide=needs, display=5]
_

que ça soit accessible à tous,

[slide=needs, display=6]
_

et que ça marche partout.
...
Déjà là, on voit qu'le contexte joue à mort.
C'est en fonction de *"ce que vous codez"* que l'importance de ces problèmes varie.
Si vous codez une app où l'utilisatrice est active (genre gMail ou Slack), la rapidité du 1er chargement c'est pas trop votre problème principal.
Même chose de l'autre côté du spectre, si vous codez une site où l'utilisateur fait bcp de lecture et de navigation,
la fluidité avec des animations à 60 fps, bah forcément, c'est pas un problème que vous avez.
...
Ne notre côté, en tant que dev, on veut :

[slide=needs, display=7]
_

Gagner du temps, ne pas réinventer la roue,

[slide=needs, display=8]
_

écrire du code propre, réutilisable,

[slide=needs, display=9]
_

avec des abstraction pour garder un modèle de pensée simple.

[slide=needs, display=10]
_

On veut une isolation des impacts de nos changements,

[slide=needs, display=11]
_

éviter de faire certaines erreurs et autres bugs...
et petit bonus,

[slide=needs, display=12]
_

si on peut facilement collaborer avec des non-dev, c'est cool.
...
Ici, c'est en fonction de *"avec qui vous codez"*, votre équipe et son expérience, que l'importance des problèmes varie.

[slide=blank]
Transition

OK, donc là, si vous êtes plutôt backend et que vous n'avez pas suivi le monde du front/Web ces dernières années,
vous vous dites :
"Non mais attend Hubert, là tu viens de lister à peu près les mêmes problèmes qu'on essayait de régler il y a 10 ans."
"J'ai vraiment l'impression que vous vous êtes complexifié la vie avec tous vos outils compliqué alors que le problème est simple."
...
OK, mettons de côté l'ironie de cette remarque et posons nous la question :

== *How* did we  get here?


[.time]#00:08:00#
Comment est-ce qu'on en est arrivé là ?
Est-ce qu'on a vraiment besoin de tous ces outils ?

[quote]
In order to understand where we're going,   we need to know where we come from.

Pour comprendre où on va, il faut savoir d'où on vient.
#blasé#
Je sais pas trop qui a dit ça, déso.
Mais il a bien raison !

image::img/drawings/browser-1.jpg[]

À la base on avait un Web assez simple mais puissant dans ses concepts.
Un utilisateur demande une URL à son navigateur,
le navigateur fait une requête HTTP vers un serveur,
le serveur applique un template et répond un document HTML,
merci au revoir.

image::img/drawings/browser-2.jpg[]

Ensuite, on a rajouté des images, des CSS et surtout des formulaires.
L'utilisateur pouvait interragir avec le document une fois qu'il était chargé.
// click
// POST
// nouvelle page HTML

image::img/drawings/browser-3.jpg[]

Ça a commencé à se complexifier assez tôt avec l'arrivée de JavaScript.
On avait maintenant la possibilité en tant que dev de répondre directement à des inputs de l'utilisateurs.
Sans faire d'aller/retour réseau.
Au départ, on faisait de la manipulation de DOM.

image::img/drawings/browser-4.jpg[]

Ensuite avec la vague AJAX, jQuery et compagnie,
on a commencé à faire faire de plus en plus de chose à cette partie JavaScript
et du coup à charger de plus de plus de code.

image::img/drawings/browser-5.jpg[]

On est passé d'appels AJAX pour récupérer des bouts de templates HTML
à faire ne récupérer que du JSON pour faire du templating côté client
et surtout du routing côté client
on gagnait bcp en perf sur les navigations consécutives

image::img/drawings/browser-6.jpg[]

par contre, le jusqueboutisme de cette logique nous a amené à une ère qui nous est encore familère,
l'ère du <body> vide avec le mega fat bundle javascript qui contient tout.
et là le premier chargement, il est pas trop content

image::img/drawings/browser-7.jpg[]

C'est un peu pour revenir au meilleur des 2 mondes
qu'on essaye aujourd'hui d'avoir un premier chargement avec rendu côté serveur qui ne contient que ce qui est nécessaire
et de charger le reste au fur et à mesure.

image::img/drawings/browser-8.jpg[]

N'oublions pas que tout ça s'est fait pendant la période de
l'arrivée des mobiles, du stockage local et des workers

image::img/drawings/browser-9.jpg[]

image::img/drawings/browser-10.jpg[]

image::img/drawings/browser-11.jpg[]

[slide=blank]
Transition

== What do *frameworks*  bring to the table?


[.time]#00:10:00#

[slide=text]
*Frameworks* vs. *libs* ?

framework => cadre de travail
opinionated set of libs/tools
problem is when this set of libs/tools is only compatible with itself
de mon expérience, les projets frameworks X ou Y ne se ressemble pas quand le contexte est différent
...
historique
jquery
Frameworks are also their to prevent browser quirks

[slide=todo-schema]
image::img/drawings-optimized/silos-colors.svg[]

Angular and ember are opinionated
React is supposed to be unopinionated
Vue is a bit in the middle
special mention to ember

[slide=todo-schema]
image::img/drawings-optimized/silos-rooms.svg[]

[slide=blank]
on efface

image::img/drawings/bookshelf-empty.jpg[]

// mentionner les étapes qui nécessitent un outil de build
// est-ce que la source de l'outil de build est spécifique ou est-elle un peu standard ?
// mentionner des détails sur les implémentations

// points importants à aborder

[slide=needs, focus=""]
Component system (API + runtime)

[slide=needs, focus="7,9"]
Component system (API + runtime)

image::img/drawings/bookshelf-1.jpg[]

Angular et Vue "data down, events up"
=> methods
React "data down, action up" (ou callback called)
=> props pour les children
Tous: attrs et lifecycle methods
Slots ?

[slide=needs, focus=""]
"Templating" / ViewModel

[slide=needs, focus="0,6,7,8,9,10,11"]
"Templating" / ViewModel

image::img/drawings/bookshelf-2.jpg[]

=> JSX, templates
=> 1 file vs several files
=> output pur JS, vs JS + CSS
Mvc, mvvm, template + vue model, computed properties
exemple Angular, React, Vue

[slide=needs, focus=""]
CSS authoring

[slide=needs, focus="0,9"]
CSS authoring

image::img/drawings/bookshelf-3.jpg[]

=> BEM, CSS-in-JS lib, encapsulation system

[slide=needs, focus=""]
DOM manipulation

[slide=needs, focus="2,3,4,5,8"]
DOM manipulation

image::img/drawings/bookshelf-4.jpg[]

=> Direct binding vs Virtual DOM (+ scheduling microtask...)
The Virtual DOM was always a big marketing argument to sell React but why would we care.
It's an implementation detail an clearly, if they changed their impl and are still fast, we should not care at all.

[slide=needs, focus=""]
SSR (Server Side Rendering)

[slide=needs, focus="0,5"]
SSR (Server Side Rendering)

image::img/drawings/bookshelf-5.jpg[]

[slide=needs, focus=""]
Router

[slide=needs, focus="1"]
Router

image::img/drawings/bookshelf-6.jpg[]

[slide=needs, focus=""]
State manager

[slide=needs, focus="7,8"]
State manager

image::img/drawings/bookshelf-7.jpg[]

image::img/drawings/bookshelf-8.jpg[]

en vrac car moins important pour notre discussion
CLI
Devtools
HTTP client
Form handling
Module system
Dep inj
i18n
tests

[slide=blank]
Transition

en terme de conception de d'organisation des composants (et de séparation des concerns etc)
les 3 communautés ont des choses intéressantes à dire

== What do *standards*  bring to the table?


[.time]#00:20:00#

image::img/screenshots/site-jquery.jpg[url=https://jquery.com/]

préambule exemple jquery => sizzle + ajax + API chainée sucre syntaxique

// [slide=todo]
// schéma cycle

.Web Components
[slide=web-components]
_

image::img/drawings-optimized/web-component-tv.svg[]
// UTILISER LE SCHEMA DE LA TV
schéma de la télé => analogie avec le Web component

image::img/drawings-optimized/web-component.svg[]

.Custom Elements
[slide=web-components]
_
// custom element => modèle de composant avec lifecycle methods et "data binding" sur les attributs

.Custom Element
[source, language=javascript, subs="none"]
--
class EnvVarInput extends HTMLElement {
    /* ... */
}

customElements.define('env-var-input', EnvVarInput);

<env-var-input name="FOO" value="BAR"></env-var-input>
--

image::img/drawings-optimized/web-component-attr.svg[]

image::img/drawings-optimized/web-component-prop.svg[]

image::img/drawings-optimized/web-component-methods.svg[]

image::img/drawings-optimized/web-component-events.svg[]

.Custom Element
[source, language=javascript, subs="none"]
--
class EnvVarInput extends HTMLElement {
    connectedCallback() {
        /* ... */
    }
    disconnectedCallback() {
        /* ... */
    }
    adoptedCallback() {
        /* ... */
    }
}
--

.Custom Element
[source, language=javascript, subs="none"]
--
class EnvVarInput extends HTMLElement {
    static get observedAttributes() {
        return ['name', 'value'];
    }
    attributeChangedCallback() {
        /* ... */
    }
}
--

// [slide=todo]
// exemples de noeuds du DOM avec des attributs

// [slide=todo]
// exemples de noeuds du DOM avec des propriétés non string/boolean
//* RO https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/dataset
//* RO https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style

// [slide=todo]
// exemples de noeuds du DOM avec des méthodes
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/submit
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/pause
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob

// [slide=todo]
// exemples de noeuds du DOM avec des événements un peu custom
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/loadstart_event
//* https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/error_event

image::img/drawings/bookshelf-wc-ce.jpg[]
//où ça se place dans notre tableau de solutions ?
//système de composant (API + runtime)

.Custom Elements
[slide=web-components, display=0]
* 🤔 No customized built-in elements in Safari
* 😐 No real "data-binding" on properties (getter/setter or proxy)
* 😡 No HMR (without hacks)
* 📜 Scoped CustomElementRegistry
* 📜 Form associated elements
* 📜 Lazy definition

.Custom Elements
[slide=web-components, display=1]
* 🤔 No customized built-in elements in Safari
* 😐 No real "data-binding" on properties (getter/setter or proxy)
* 😡 No HMR (without hacks)
* 📜 Scoped CustomElementRegistry
* 📜 Form associated elements
* 📜 Lazy definition

.Custom Elements
[slide=web-components, display=2]
* 🤔 No customized built-in elements in Safari
* 😐 No real "data-binding" on properties (getter/setter or proxy)
* 😡 No HMR (without hacks)
* 📜 Scoped CustomElementRegistry
* 📜 Form associated elements
* 📜 Lazy definition

.Custom Elements
[slide=web-components, display=3]
* 🤔 No customized built-in elements in Safari
* 😐 No real "data-binding" on properties (getter/setter or proxy)
* 😡 No HMR (without hacks)
* 📜 Scoped CustomElementRegistry
* 📜 Form associated elements
* 📜 Lazy definition

.Custom Elements
[slide=web-components, display=4]
* 🤔 No customized built-in elements in Safari
* 😐 No real "data-binding" on properties (getter/setter or proxy)
* 😡 No HMR (without hacks)
* 📜 Scoped CustomElementRegistry
* 📜 Form associated elements
* 📜 Lazy definition

.Custom Elements
[slide=web-components, display=5]
* 🤔 No customized built-in elements in Safari
* 😐 No real "data-binding" on properties (getter/setter or proxy)
* 😡 No HMR (without hacks)
* 📜 Scoped CustomElementRegistry
* 📜 Form associated elements
* 📜 Lazy definition

.Custom Elements
[slide=web-components, display=6]
* 🤔 No customized built-in elements in Safari
* 😐 No real "data-binding" on properties (getter/setter or proxy)
* 😡 No HMR (without hacks)
* 📜 Scoped CustomElementRegistry
* 📜 Form associated elements
* 📜 Lazy definition

.Shadow DOM
[slide=web-components]
_
//shadow DOM => isolation du CSS

image::img/drawings-optimized/web-component-slot.svg[]

image::img/drawings-optimized/web-component-events.svg[]

image::img/drawings-optimized/web-component-sd.svg[]

la suite de l'API standard entrée/sortie (custom prop, ::part)
système de slots :+1
transperce le shadow root avec des custom props
transperce le shadow root avec des ::part (et ::theme)

// [slide=todo]
// exemples de noeuds du DOM avec des ::part ou des custom prop

image::img/drawings/bookshelf-wc-sd.jpg[]

où ça se place dans notre tableau de solutions ?
système de composants
isolation du CSS

.Shadow DOM
[slide=web-components, display=0]
* 😡 No SSR (without hacks)
* 📜 Declarative shadow DOM, custom elements
* 📜 Custom pseudo class
* 📜 CSS modules

.Shadow DOM
[slide=web-components, display=1]
* 😡 No SSR (without hacks)
* 📜 Declarative shadow DOM, custom elements
* 📜 Custom pseudo class
* 📜 CSS modules

.Shadow DOM
[slide=web-components, display=2]
* 😡 No SSR (without hacks)
* 📜 Declarative shadow DOM, custom elements
* 📜 Custom pseudo class
* 📜 CSS modules

.Shadow DOM
[slide=web-components, display=3]
* 😡 No SSR (without hacks)
* 📜 Declarative shadow DOM, custom elements
* 📜 Custom pseudo class
* 📜 CSS modules

.Shadow DOM
[slide=web-components, display=4]
* 😡 No SSR (without hacks)
* 📜 Declarative shadow DOM, custom elements
* 📜 Custom pseudo class
* 📜 CSS modules

.`<template>`
[slide=web-components]
_
// <template>, une manière "efficace" de cloner du DOM

.<template>
[source, language=html, subs="none"]
--
<template id="foobar">
  <div>Awesome!!</div>
</template>

const awesome = foobar.content.cloneNode(true);
parent.appendChild(awesome)
--

image::img/drawings/bookshelf-wc-tpl.jpg[]
//où ça se place dans notre tableau de solutions ?
//pas vraiment équivalent à la définition de template qu'on a évoqué mais bon

.`<template>`
[slide=web-components, display=0]
* 😡 No interpolation or reactive "data-binding"
* 📜 Template instanciation (limited to simple values)
* 📜 HTML modules

.`<template>`
[slide=web-components, display=1]
* 😡 No interpolation or reactive "data-binding"
* 📜 Template instanciation (limited to simple values)
* 📜 HTML modules

.`<template>`
[slide=web-components, display=2]
* 😡 No interpolation or reactive "data-binding"
* 📜 Template instanciation (limited to simple values)
* 📜 HTML modules

.`<template>`
[slide=web-components, display=3]
* 😡 No interpolation or reactive "data-binding"
* 📜 Template instanciation (limited to simple values)
* 📜 HTML modules

image::img/screenshots/web-components-best-practices.jpg[url=https://developers.google.com/web/fundamentals/web-components/best-practices]

//comment surveiller la suite

image::img/screenshots/github-web-components.jpg[url=https://github.com/w3c/webcomponents]

image::img/screenshots/twitter-intenttoship.jpg[url=https://twitter.com/intenttoship]

image::img/screenshots/twitter-WebPlatformNews.jpg[url=https://twitter.com/WebPlatformNews]

// image::img/screenshots/github-tc39.jpg[url=https://github.com/tc39/proposals]

// des resources pour surveiller les specs et les implems dans les browsers
// TC39

//Est-ce que votre outil est prêt demain à adopter un standard et jetter son implem pour vous faire profiter du support natif ?

[slide=blank]
Transition

Maintenant qu'on a déconstruit un peu les différentes solutions qu'apportent les frameworks et les standards,
on a une meilleure vision des différentes couches qui composent un projet Web,
et du coup, il est temps d'appliquer...

== A *SOLID* Web!

[.time]#00:30:00#
...les principes SOLID à notre frontend préféré.
Je vais prendre l'exemple du travail que je fais en ce moment...

[quote]
Code should be disposable,   it's far easier to do when   things are decoupled.

.Our context at *Clever Cloud*
[.logo]
image::img/cc-rocket-man.png[]
//image::img/clever-cloud-logo.svg[]

...chez Clever Cloud,
en espérant que ça vous donne des idées pour votre contexte et votre stack.

[slide=blank, data-viewport=1]
_

Démo console
ça c'est ce qu'on appelle notre console,
c'est le tableau de bord qui permet à nos clients d'administrer leurs apps, leurs bdd, leurs addons...
montrer la console web en démo
(écran overview)
citer logs, monitoring...
(switcher sur les vars d'env)

image::img/drawings/bookshelf-cc-before.jpg[]

la stack Clever
...
codebase qui a 7 ans
Component system (séparation du code mais pas d'API ni de système runtime)
Templating (lodash)
CSS (global) avec qq règle de nommage parfois
DOM (jquery + bacon)
Pas de SSR
Router maison (merci quentin)
Pas vrmt de state manager (bacon)

.Our needs
[slide=web-components, display=0]
* 👋 Goodbye (Bacon.js + lodash templates)
* 💪 Components with an API and isolation
* ♻️ Reusability (white label products)
* 🤯 No feature less "big-bang" refactoring
* 🔢 Introduce new tools feature by feature

.Our needs
[slide=web-components, display=1]
* 👋 Goodbye (Bacon.js + lodash templates)
* 💪 Components with an API and isolation
* ♻️ Reusability (white label products)
* 🤯 No feature less "big-bang" refactoring
* 🔢 Introduce new tools feature by feature

.Our needs
[slide=web-components, display=2]
* 👋 Goodbye (Bacon.js + lodash templates)
* 💪 Components with an API and isolation
* ♻️ Reusability (white label products)
* 🤯 No feature less "big-bang" refactoring
* 🔢 Introduce new tools feature by feature

.Our needs
[slide=web-components, display=3]
* 👋 Goodbye (Bacon.js + lodash templates)
* 💪 Components with an API and isolation
* ♻️ Reusability (white label products)
* 🤯 No feature less "big-bang" refactoring
* 🔢 Introduce new tools feature by feature

.Our needs
[slide=web-components, display=4]
* 👋 Goodbye (Bacon.js + lodash templates)
* 💪 Components with an API and isolation
* ♻️ Reusability (white label products)
* 🤯 No feature less "big-bang" refactoring
* 🔢 Introduce new tools feature by feature

.Our needs
[slide=web-components, display=5]
* 👋 Goodbye (Bacon.js + lodash templates)
* 💪 Components with an API and isolation
* ♻️ Reusability (white label products)
* 🤯 No feature less "big-bang" refactoring
* 🔢 Introduce new tools feature by feature

sur certaines parties de l'app, on avait déjà un modèle
comme les frameworks moderne avec un one way data flow
je modifie de la donnée, ça par dans un stream bacon et ça modifie le DOM
on a un peu atteint les limites de ce modèle bacon + lodash (perfs et modèle de pensée)
on a isolé les "modules" dans des fichiers mais on a du CSS global et on a pas d'interface clairement définie sur nos composants
on va avoir besoin que notre UI soit réutilisée en marque blanche ou marque grise
du coup, on doit pouvoir fournir certains parties de manière indépendantes un peu comme des légos
// donnée qui vient d'appels REST et/ou de SSE
...
on va introduire des nouvelles technos feature après feature
le fait que notre code n'était pas enfermé dans un framework nous facilite cette migration
Les commentaires, c'est pour tes collègues, mais c'est surtout pr toi dans 6 mois un an. Les composants Web c'est pareil. C'est pour que des tiers puissent les utiliser dans d'autres contextes et pour que toi tu puisses changer ta stack dans 6 mois.

[slide=text]
Design phase:   from *top* to *bottom*

// [slide=todo]
// mock-up top => bottom des vars d'env

[slide=text]
Development phase:   from *bottom* to *top*

les enfants ne savent pas qui les utilisent
mais ils ont une idées de comment ils seront utilisés ou plutôt de ce qu'ils doivent faire
les parents savent à quoi servent leur enfants mais ne se soucis pas de comment ça marche à l'interieur
tu ne sais pas qu'il y a un router
tu ne sais pas qu'il y a un state manager
tu ne sais pas d'où vient la donnée

[slide=text]
*Storybook* **D**riven **D**evelopment

YOU NEED A DESIGN SYSTEM

//image::img/talk-storybook-ml-thuret.jpg[url=https://www.youtube.com/watch?v=a-fsVBaiv5A]
image::img/talk-storybook-ml-thuret.en.jpg[]

[slide=blank, data-viewport=2]
DÉMO: le storybook de clever

DÉMO: le storybook de clever
montrer les boutons avec leur interface
montrer le composant env-var-input
montrer le composant env-var-editor-simple
montrer le composant env-var-editor-expert
expliquer qu'ils ont la même signature et son donc très facilement interchangeable aux yeux du parent

image::img/drawings/bookshelf-cc-after.jpg[]

: web component pour la réutilisabilité et le côté agnostique du fwk et l'aspect standard
: lit-element + lit-html (petites libs)
: on en a testé d'autres mais celles si nous convenait le mieux

image::img/screenshots/site-lit-html.jpg[url=https://lit-html.polymer-project.org/]

.lit-html
[source, language=javascript, subs="none"]
--
import { html, render } from 'lit-html';

let envVarInput = (envVar) => html`
    <span class="name">${envVar.name}</span>
    <input name=${envVar.name} .value=${envVar.value}>
`;

render(envVarInput({ name: 'FOO', value: 'BAR' }), someDomNode);
--

image::img/screenshots/site-lit-element.jpg[url=https://lit-element.polymer-project.org/]

.LitElement
[source, language=javascript, subs="none"]
--
import { LitElement, html } from 'lit-element';

class EnvVarInput extends LitElement {

  render() {
    return html`
      <!-- My template here -->
    `;
  }
}

customElements.define('env-var-input', EnvVarInput);
--

//[slide=text]
//Séparation des *préoccupations*   #≠#   Séparation des *fichiers*
//Séparation des *préoccupations*   #!==#   Séparation des *fichiers*
//Séparation des *préoccupations*  *!==* Séparation des *fichiers*

// [quote]
// The more experienced a developer is, the less they are willing to be constraint by a framework. They tend to look for tools that help them and get out of the way.
// https://hueniverse.com/http-frameworks-must-die-717a37b6b164

image::img/drawings-optimized/layers-mixed-light.svg[]

image::img/drawings-optimized/layers-light.svg[]

layer data aware
layer auth aware
elements qui font des appels REST

// [slide=todo]
// remonter l'accès à la donnée le plus haut possible

.Reduce coupling with global stuffs
[slide=web-components]
* Router
* Data management (REST, WS, SSE...)
* State management
* Loading indicators
* Messages, notifs (info, error...)
* Modal box
* Keyboard shortcuts
//* document.title
// i18n

// i18n
// packaging
// Tests: do it like a  screen reader user wood do it
// Tests: no a great fan of snapshots

[slide=text]
Did we choose the *right tool*?

[.osef, slide=text]
*IDGAS™️*

[slide=text]
Not the *right* question!

[slide=text]
How much does it *cost*   to *change* our minds?

Est-ce qu'on a fait le bon choix avec cette stack ?
Oui, pas au sens ou on a choisi la bonne solution.
Au sens ou on pourra changer d'avis demain,
garder des composants longtemps avec ce choix sans les retoucher, et tant pis car ils sont petit
les réécrire avec des outils différents car l'impact sur les autres couches sera faible.
On s'en fout !
On a fait un choix qui ne nous demande pas trop d'apprentissage spécifique (lit-element, lit-html),
qui nous donne des connaissances de nouveaux standards du Web,
ça ne peut qu'être positif !

[slide=blank]
Transition

== Looking into  the *future*...


[.time]#00:40:00#

[slide=text]
*Beware* of those who   predict the future**!**

//See WC as the bytecode of the component isolation concept. It can be a compile to target
//People don't have to worry on the sugar

image::img/screenshots/article-frameworks-without-the-framework.jpg[url=https://svelte.technology/blog/frameworks-without-the-framework]

Vous pensez que 100k de JS, c'est pareil que 100k d'image => faux
Le JS est téléchargé, parsé, éxécuté, tout ça, ça prend du temps.

image::img/screenshots/article-compilers-are-the-new-frameworks.jpg[url=https://tomdale.net/2017/09/compilers-are-the-new-frameworks/]

//image::img/screenshots/tweet-future-web-assembly.jpg[url=https://twitter.com/getify/status/1111004737263075329]

//* le i18n (inliné)
//Discuter des webcomponent comme base pour l'authoring ou comme target de compilation

//[slide=todo-screenshot]
//Web Assembly

image::img/drawings/browser-12.jpg[]

image::img/drawings/browser-13.jpg[]

image::img/drawings/browser-14.jpg[]

framework runtime => compilers
schéma browser avec le code qui passe du runtime au build
bon ou mauvais ?
l'idéal serait que l'input du compiler fonctionne sans build step et que l'output soit optimisé aux petits oignons, comme ce qu'on fait quand on minifie
schéma browser avec le code qui passe du runtime et vers des implem du browser
...
Convaincre les gens que :
Le passé se répète
Les outils vont et viennent
La constante, c'est le modèle des éléments du DOM (sorte de HDMI du Web)
Tout comme on a appris à apprendre mais on garde certaines bases fondamentales, ils faut capitaliser sur les bases fondamentales (le web et ses standards) et adopter des facilitants par dessus avec une courbe d'apprentissage
// Ne pas hésiter à questionner les standards ou les frameworks à la mode
// Qu'est-ce qui est important ? L'UX, la DX, les perfs ?
// On est trop dépendant de nos outils
// On est pas tjs assez exigent avec nos outils
// Il faut plus de compilation (html, css, js) et donc une étape intermédiaire
// Ça facilite le SSR, le HMR, plus résilient aux vieux browsers
// Compiler le i18n

[.stop-music.dark, slide=blank]
Fondu vers le noir

[.old.play-music]
== ...Epilogue

[.time]#00:42:00#

.So?
[slide=bubble]
image::img/drawings-optimized/talking-legos-r-talks.svg[]

👩‍⚕️ So? How was your group therapy?
😎 I don't know, it didn't have time to go into each details so instead,
I tried to share the way I see things so people can adapt to their own context.

.Problem #1
[slide=problem]
Finding solutions   to problems we don't have (yet)

😎 For problem number 1,
I tried to insist and move the focus back on needs:
1. Needs of the people using the products we build
2. Needs of the development team who works on the project
...
Un navigateur Web est devenu aujourd'hui, *une plateforme applicative assez complexe*.
Bien sûr qu'on a besoins d'outils à la hauteur des enjeux. L'idée n'est pas de tout faire à la main et de réinventer la roue.
Après, ça veut pas dire qu'on a tous les mêmes contextes et les mêmes priorités.
...
J'espère que les gens auront le réflexe :
* "ah un nouvel outil qui brille !"
* "ça résoud quel problème ?"
* "est-ce que j'ai ce problème ?"
et de savoir :
* ce que vous codez
* et avec qui vous codez

.Problem #2
[slide=problem]
Getting locked into our own ecosystem

😎 J'ai aussi essayé de déconstruire les différentes fonctionnalités/solutions qu'apportent des 3 écosystèmes du moment.
L'idée principale est bien d'avoir un regard plus critique et une vision horizontale plutôt qu'une vision verticale.
Pour ma part, en comprenant mieux ces parties, j'ai moins peur des les remplacer par des implems plus simples ou mieux adaptés ou pars des nouveaux standards.
En fait, au final, tous ces frameworks, ces librairies et ces standards, ça n'est que des outils.
On a juste besoin de tous rester calmes et professionnels,
les utiliser pour les supers fonctionnalités qu'ils nous apportent
et arrêter de les idôlatrer aveuglement.
👩‍⚕️ Et vous leur avez parlé des TV magnétoscopes

.Problem #3
[slide=problem]
Writing strongly coupled code   that does not age well with time

😎 Oui, j'ai expliqué comment chez Clever Cloud on essaye de réduire le couplage entre nos différents composants, modules et couche applicatives.
J'ai évoqué ce que ça nous apporte dans notre contexte bien précis.
On a rien inventé, on essaye d'appliquer les bons vieux patterns logiciels au Web moderne.
Ça reste un principe, il y a tjs des exceptions.
L'idée n'est pas de quadrupler les coûts de conception juste pour faire du "beau code" mais bien d'investir un minimum d'énergie pour réduire les effets du temps.

.Thanks doctor!
[slide=bubble]
image::img/drawings-optimized/talking-legos-l-love.svg[]

😎 Je vous remercie docteur, ça m'a bien aidé
et je tiens également à remercie tous les membres du groupe qui m'ont écouté jusqu'au bout.

.thank  you !
[.reset-music, slide=poster]
Outro

Merci bcp.

//[slide=question]
//Questions ?
